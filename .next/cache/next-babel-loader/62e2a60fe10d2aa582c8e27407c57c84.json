{"ast":null,"code":"function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport ChartComponent from './base/ChartComponent';\nimport d3 from './utils/d3';\nimport defaultData from './defaultData.json'; // see docs on https://github.com/reuters-graphics/graphics-atlas-client\n\nimport AtlasMetadataClient from '@reuters-graphics/graphics-atlas-client';\nconst atlastClient = new AtlasMetadataClient();\nconst dateParse = d3.timeParse('%Y-%m-%d');\nconst dateFormat = d3.timeFormat('%b %e');\nconst dateFormat_tt = d3.timeFormat('%B %e');\nconst numberFormat_tt = d3.format(',');\n\nclass CountryLockdownIndicatorStrips extends ChartComponent {\n  constructor(...args) {\n    super(...args);\n\n    _defineProperty(this, \"defaultProps\", {\n      locale: 'en',\n      countryISO2: 'IN',\n      dataParams: {\n        date: 'date',\n        index: 'c1',\n        steps: 2,\n        // stepValue = 0, 1...\n        stepValue: 'flag'\n      },\n      height: 200,\n      margin: {\n        top: 10,\n        right: 10,\n        bottom: 10,\n        left: 10\n      },\n      valign: 'center',\n      // start, center, baseline\n      baseColor: '#ECEFF4',\n      stripColor: {\n        0: '#ECEFF4',\n        1: '#d1eeea',\n        2: '#ffe47f',\n        3: '#a50f15'\n      },\n      scaleColor: 'scaleDiverging' // scaleDiverging, scale\n\n    });\n\n    _defineProperty(this, \"defaultData\", defaultData);\n  }\n\n  draw() {\n    const data = this.data();\n    const props = this.props();\n    const node = this.selection().node(); // get country details from AtlasClient from ISO-2\n\n    props.country = atlastClient.getCountry(props.countryISO2);\n    const {\n      width\n    } = node.getBoundingClientRect();\n    const transition = d3.transition().duration(750); // main chart container\n\n    const chartDiv = this.selection().appendSelect('div') // see docs in ./utils/d3.js\n    .attr('class', 'CountryLockdownIndicatorStrips').style('width', `${width}px`).style('height', `${props.height}px`).appendSelect('div').style('transform', `translate(${props.margin.left}px, ${props.margin.top}px)`); // set scales\n\n    const yScale = d3.scaleLinear().domain([0, props.dataParams.steps - 1]).range([props.height - props.margin.bottom, props.margin.top]);\n    const xScale = d3.scaleBand().domain(data.map(d => dateParse(d[props.dataParams.date]))).range([props.margin.left, width - props.margin.right]).padding(0);\n    const colorDomain = props.stripColor ? Object.keys(props.stripColor) : colorDomain;\n    const colorScale = d3[props.scaleColor].domain(colorDomain).range(); // make bars\n\n    const bars = chartDiv.appendSelect('div.bars-container').style('display', 'flex').style('align-items', `${props.valign}`).selectAll('.bar').data(data, (d, i) => d[props.dataParams.date]); // for smooth data updation\n\n    bars.enter().append('div').attr('class', d => `bar ${d[props.dataParams.date]}`).style('height', d => {\n      const stepSize = (props.height - props.margin.top - props.margin.bottom) / props.dataParams.steps;\n      const step = d[props.dataParams.stepValue] + 1;\n      return d[props.dataParams.index] ? step ? step * stepSize + 'px' : stepSize + 'px' : stepSize + 'px';\n    }).style('width', xScale.bandwidth() + 'px').style('display', 'inline-block').style('background', props.baseColor); // const circles = g.selectAll('circle')\n    //   .data(data, (d, i) => d[props.dataParams.date]);\n    // circles\n    //   .style('fill', props.fill)\n    //   .style('stroke', props.stroke);\n    // circles.enter().append('circle')\n    //   .style('fill', props.fill)\n    //   .style('stroke', props.stroke)\n    //   .style('stroke-width', props.strokeWidth)\n    //   .attr('cy', props.height / 2)\n    //   .attr('cx', (d, i) =>\n    //     data.slice(0, i).reduce((a, b) => a + b, 0) + (d / 2)\n    //   )\n    //   .merge(circles)\n    //   .transition(transition)\n    //   .attr('cx', (d, i) =>\n    //     data.slice(0, i).reduce((a, b) => a + b, 0) + (d / 2)\n    //   )\n    //   .attr('r', d => d / 2);\n    // circles.exit()\n    //   .transition(transition)\n    //   .attr('r', 0)\n    //   .remove();\n\n    return this;\n  }\n\n} // console.log(this.defaultProps);\n\n\nexport default CountryLockdownIndicatorStrips;","map":{"version":3,"sources":["/Users/prasanta/ReutersWork/INTERACTIVES/COVID-APP/chart-module-CountryLockdownIndicatorStrips/src/lib/chart.js"],"names":["ChartComponent","d3","defaultData","AtlasMetadataClient","atlastClient","dateParse","timeParse","dateFormat","timeFormat","dateFormat_tt","numberFormat_tt","format","CountryLockdownIndicatorStrips","locale","countryISO2","dataParams","date","index","steps","stepValue","height","margin","top","right","bottom","left","valign","baseColor","stripColor","scaleColor","draw","data","props","node","selection","country","getCountry","width","getBoundingClientRect","transition","duration","chartDiv","appendSelect","attr","style","yScale","scaleLinear","domain","range","xScale","scaleBand","map","d","padding","colorDomain","Object","keys","colorScale","bars","selectAll","i","enter","append","stepSize","step","bandwidth"],"mappings":"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","sourcesContent":["import ChartComponent from './base/ChartComponent';\nimport d3 from './utils/d3';\nimport defaultData from './defaultData.json';\n\n// see docs on https://github.com/reuters-graphics/graphics-atlas-client\nimport AtlasMetadataClient from '@reuters-graphics/graphics-atlas-client';\nconst atlastClient = new AtlasMetadataClient();\n\nconst dateParse = d3.timeParse('%Y-%m-%d');\nconst dateFormat = d3.timeFormat('%b %e');\nconst dateFormat_tt = d3.timeFormat('%B %e');\nconst numberFormat_tt = d3.format(',');\n\nclass CountryLockdownIndicatorStrips extends ChartComponent {\n    defaultProps = {\n      locale: 'en',\n      countryISO2: 'IN',\n      dataParams: {\n        date: 'date',\n        index: 'c1',\n        steps: 2, // stepValue = 0, 1...\n        stepValue: 'flag',\n      },\n      height: 200,\n      margin: {\n        top: 10,\n        right: 10,\n        bottom: 10,\n        left: 10,\n      },\n      valign: 'center', // start, center, baseline\n      baseColor: '#ECEFF4',\n      stripColor: {\n        0: '#ECEFF4',\n        1: '#d1eeea',\n        2: '#ffe47f',\n        3: '#a50f15',\n      },\n      scaleColor: 'scaleDiverging', // scaleDiverging, scale\n    };\n\n    defaultData = defaultData;\n\n    draw() {\n      const data = this.data();\n      const props = this.props();\n      const node = this.selection().node();\n\n      // get country details from AtlasClient from ISO-2\n      props.country = atlastClient.getCountry(props.countryISO2);\n\n      const {\n        width,\n      } = node.getBoundingClientRect();\n\n      const transition = d3.transition()\n        .duration(750);\n\n      // main chart container\n      const chartDiv = this.selection()\n        .appendSelect('div') // see docs in ./utils/d3.js\n        .attr('class', 'CountryLockdownIndicatorStrips')\n        .style('width', `${width}px`)\n        .style('height', `${props.height}px`)\n        .appendSelect('div')\n        .style('transform', `translate(${props.margin.left}px, ${props.margin.top}px)`);\n\n      // set scales\n      const yScale = d3.scaleLinear()\n        .domain([0, props.dataParams.steps - 1])\n        .range([props.height - props.margin.bottom, props.margin.top]);\n\n      const xScale = d3.scaleBand()\n        .domain(data.map(d => dateParse(d[props.dataParams.date])))\n        .range([props.margin.left, width - props.margin.right])\n        .padding(0);\n\n      const colorDomain = props.stripColor ? Object.keys(props.stripColor) : colorDomain;\n      const colorScale = d3[props.scaleColor].domain(colorDomain).range();\n\n      // make bars\n      const bars = chartDiv.appendSelect('div.bars-container')\n        .style('display', 'flex')\n        .style('align-items', `${props.valign}`)\n        .selectAll('.bar')\n        .data(data, (d, i) => d[props.dataParams.date]); // for smooth data updation\n\n      bars.enter().append('div')\n        .attr('class', d => `bar ${d[props.dataParams.date]}`)\n        .style('height', d => {\n          const stepSize = (props.height - props.margin.top - props.margin.bottom) / props.dataParams.steps;\n          const step = d[props.dataParams.stepValue] + 1;\n          return d[props.dataParams.index] ? (step ? step * stepSize + 'px' : stepSize + 'px') : stepSize + 'px';\n        })\n        .style('width', xScale.bandwidth() + 'px')\n        .style('display', 'inline-block')\n        .style('background', props.baseColor);\n\n      // const circles = g.selectAll('circle')\n      //   .data(data, (d, i) => d[props.dataParams.date]);\n\n      // circles\n      //   .style('fill', props.fill)\n      //   .style('stroke', props.stroke);\n\n      // circles.enter().append('circle')\n      //   .style('fill', props.fill)\n      //   .style('stroke', props.stroke)\n      //   .style('stroke-width', props.strokeWidth)\n      //   .attr('cy', props.height / 2)\n      //   .attr('cx', (d, i) =>\n      //     data.slice(0, i).reduce((a, b) => a + b, 0) + (d / 2)\n      //   )\n      //   .merge(circles)\n      //   .transition(transition)\n      //   .attr('cx', (d, i) =>\n      //     data.slice(0, i).reduce((a, b) => a + b, 0) + (d / 2)\n      //   )\n      //   .attr('r', d => d / 2);\n\n      // circles.exit()\n      //   .transition(transition)\n      //   .attr('r', 0)\n      //   .remove();\n\n      return this;\n    }\n}\n// console.log(this.defaultProps);\nexport default CountryLockdownIndicatorStrips;\n"]},"metadata":{},"sourceType":"module"}